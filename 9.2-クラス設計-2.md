引き続きクラス設計について説明します。

## Objective-C における抽象クラス

9.1 で例として挙げた仕様がありました。

> - ファーストビューので、曜日ごとに違う画像を表示したい
> - その画像をタップした際の画面遷移やアクションが画像によってことなる

この仕様が画像では無く、様々な種類のビューをオーバーレイし、×ボタンを押すと閉じることが出来るように変更したいとします。

![abstractClass1](https://raw.github.com/mixi-inc/iOSTraining/master/Doc/Images/9.2/abstractClass1.png)

この場合は、一つのカスタムビュークラスでテキストビューやイメージビューなどのサブビューを条件分岐で表示非表示にしがちです。しかし、そうしてしまうとコードにレイアウトのコードが増えたり、ビューの種類が増えてきた場合に条件分岐がさらに多くなり対応が難しくなります。

こういったケースでは抽象クラスを使うと上記の問題は解決できます。

**ポイント**
Objective-C では、抽象クラスを作成する言語的機能（Java の abstract 修飾子など）は存在しません。よって、抽象クラスとして作成したクラスのインスタンスも生成可能です。NSObject クラスのインスタンスが生成可能なように、Objective-C では抽象クラスの扱いに関しては開発者側で行う必要があります。

上記の例では抽象クラスを作成し、そのサブクラスで適宜必要なコンポーネントとレイアウトの実装を行うと良いでしょう。

![abstractClass1](https://raw.github.com/mixi-inc/iOSTraining/master/Doc/Images/9.2/abstractClass2.png)

では実際に実装していきましょう。

抽象クラス MixiDailyAbstractView では xib ファイルは作成せず、.h .m ファイルだけ作成します。

MixiDailyAbstractView.h
```objective-c
@protocol MixiDailyViewDelegate <NSObject>

-(void)dailyViewDidPressCloseButton;

@end

@interface MixiDailyAbstractView : UIView

@property (nonatomic, weak) IBOutlet UILabel *titleLabel;
@property (nonatomic, weak) IBOutlet UIButton *closeButton;
@property (nonatomic, weak) IBOutlet UILabel *dateLabel;
@property (nonatomic, weak) id delegate;

-(IBAction)pressCloseButton:(id)sender;

@end
```

MixiDailyAbstractView.m
```objective-c
#import "MixiDailyAbstractView.h"

@implementation MixiDailyAbstractView


-(void)pressCloseButton:(id)sender
{
    if ([_delegate respondsToSelector:@selector(dailyViewDidPressCloseButton)]) {
        [_delegate dailyViewDidPressCloseButton];
    }
}

@end
```

実装クラスである MixiDailyChoiceView では .h, .m に加えて .xib まで作成して実装します。

MixiDailyChoiceView.h
```objective-c
#import "MixiDailyAbstractView.h"

@interface MixiDailyChoiceView : MixiDailyAbstractView

+(MixiDailyChoiceView *)dailyChoiceView;
- (IBAction)pressYesButton:(id)sender;
- (IBAction)pressNoButton:(id)sender;

@end
```

MixiDailyChoiceView.m
```objective-c
#import "MixiDailyChoiceView.h"

@implementation MixiDailyChoiceView

+(MixiDailyChoiceView *)dailyChoiceView
{
    NSArray *topLevelViews = [[NSBundle mainBundle] loadNibNamed:@"dailyChoiceView"
                                                           owner:self
                                                         options:nil];
    MixiDailyChoiceView *dailyChoiceView = topLevelViews[0];
    return dailyChoiceView;
}

- (IBAction)pressYesButton:(id)sender
{
    //do something
}

- (IBAction)pressNoButton:(id)sender
{
    //do something
}

@end

```

MixiDailyChoiceView.xib

![MixiDailyChoiceView-xib](https://raw.github.com/mixi-inc/iOSTraining/master/Doc/Images/9.2/MixiDailyChoiceView-xib.png)

インスタンスを生成して表示させた結果です。

![MixiDailyChoiceView](https://raw.github.com/mixi-inc/iOSTraining/master/Doc/Images/9.2/MixiDailyChoiceView.png)
